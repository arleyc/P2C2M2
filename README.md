
<!-- README.md is generated from README.Rmd. Please edit that file -->

# P2C2M2

<!-- badges: start -->
<!-- badges: end -->

P2C2M2 provides functions to read default output from BEAST2 (….) and
starBEAST2 (….) and conduct posterior predictive checks of coalescent
models (Reid et al. 2014) based on the functions originally provided in
the P2C2M package (Gruenstaeudl et al….) to parse tree and xml files
from BEAST and \*BEAST. It also implements estimation of type-I (false
-positive) error rates using pseudo-observed datasets (“pods”) sampled
from the posterior predictive distribution.

## Installation

You can install the development version of P2C2M2 from
[GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("arleyc/P2C2M2")
```

## Example

This is a basic example which shows you how to solve a common problem:

``` r
library(P2C2M2)
# The absolute path to the input directory is set
inPath <- system.file("extdata", "thomomys/", package="P2C2M2")

# The name of the xml-file generated by BEAUTi and located in 
# "inPath" is set
inFile <- "thomomys.xml"

# Posterior predictive simulations with a setting of 2 simulation 
# replicates are preformed
suppressWarnings(thomomys <- p2c2m2.complete(inPath, inFile, num.reps=2, 
  error.rate = TRUE))
#> 
#> bindings, loci, and alignments read
#> 
#> locus 26 is done
#> 
#> locus 29 is done
#> 
#> locus 47 is done
#> 
#> locus 53 is done
#> 
#> locus 59 is done
#> 
#> locus 64 is done
#> 
#> locus 72 is done
#> 
#> gene trees done
#> 
#> species trees done
#> 
#> Calculating metrics for 3 trees of the posterior distribution
#> 
#> Calculating metrics for the trees of the post. predictive distribution
#> 
#> Calculating differences btw. the posterior and the post. predictive distribution
#> 
#> Calculating differences btw. 1000 pods and the post. predictive distribution to estimate error rates

thomomys$results$alpha0.01
#> $perGene
#>    LCWT[2]                NDC[2]              
#> 26 "-8.31 (±34.92) n.s."  "-1.33 (±9.45) n.s."
#> 29 "-23.76 (±28.02) n.s." "-0.33 (±6.35) n.s."
#> 47 "13.5 (±18.6) n.s."    "1.67 (±6.66) n.s." 
#> 53 "-16.49 (±19.47) n.s." "4.67 (±3.79) *"    
#> 59 "-1.07 (±16.02) n.s."  "-1.67 (±7.37) n.s."
#> 64 "-35.47 (±9.23) *"     "15.67 (±4.93) *"   
#> 72 "22.62 (±22.43) n.s."  "-7.67 (±8.14) *"   
#> 
#> $acrGenes
#>        LCWT[2]               NDC[2]               
#> Sum    "-32.5 (±92.95) n.s." "8.71 (±12.85) n.s." 
#> Mean   "-4.64 (±13.28) n.s." "1.24 (±1.84) n.s."  
#> Median "-6.02 (±22.55) n.s." "3 (±7.44) n.s."     
#> Mode   "9.48 (±24.77) n.s."  "-0.71 (±11.88) n.s."
#> CV     "0.17 (±2.29) n.s."   "-5.59 (±10.35) n.s."
#> 
#> $perGene.error
#>    LCWT[2] NDC[2]
#> 26   0.690  0.663
#> 29   0.648  0.658
#> 47   0.690  0.663
#> 53   0.662  0.658
#> 59   0.662  0.658
#> 64   0.662  0.663
#> 72   0.662  1.000
#> 
#> $acrGenes.error
#>        LCWT[2] NDC[2]
#> Sum       0.69  0.342
#> Mean      0.69  0.342
#> Median    0.00  0.000
#> Mode      0.00  0.000
#> CV        0.69  1.000

thomomys$results$legend
#> [1] "Differences between the posterior and the posterior predictive distributions per locus and across loci. Each cell contains the following information in said order: mean, standard deviation, significance level. Error rates (if estimated with option error.rate=TRUE) are based on differences between the pods and the posterior predictive distributions. Codes in square brackets indicate the number of tails. Alpha values are automatically adjusted for the number of tails."
```
