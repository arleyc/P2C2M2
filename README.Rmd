---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# P2C2M2

<!-- badges: start -->
<!-- badges: end -->

P2C2M2 provides functions to read default output from BEAST2 
  (....) and starBEAST2 (....)
  and conduct posterior predictive checks of coalescent models (Reid
  et al. 2014) based on the functions originally provided in the P2C2M
  package (Gruenstaeudl et al. 2016) to parse tree and xml files from
  BEAST and *BEAST. It also implements estimation of type-I (false
  -positive) error rates using pseudo-observed datasets ("pods")
  sampled from the posterior predictive distribution.

## Installation

You can install the development version of P2C2M2 from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("arleyc/P2C2M2")
```

## Example

This is a basic example which shows you how to solve a common problem:

```{r example}
library(P2C2M2)
# The absolute path to the input directory is set
inPath <- system.file("extdata", "thomomys/", package="P2C2M2")

# The name of the xml-file generated by BEAUTi and located in 
# "inPath" is set
inFile <- "thomomys.xml"

# Posterior predictive simulations with a setting of 2 simulation 
# replicates are preformed
suppressWarnings(thomomys <- p2c2m2.complete(inPath, inFile, num.reps=2, 
  error.rate = TRUE))

thomomys$results$alpha0.01

thomomys$results$legend
```

## References

Beast2

StarBeast2

Reid, N.M., Brown, J.M., Satler, J.D., Pelletier, T.A., McVay, J.D., Hird, S.M. and Carstens, B.C. (2014) Poor fit to the multi-species coalescent model is widely detectable in empirical data. Systematic Biology, 63, 322--333.

Gruenstaeudl, M., Reid, N.M., Wheeler, G.R. and Carstens, B.C. (2016) Posterior predictive checks of coalescent nodels: P2C2M, an R package. Molecular Ecology Resources}, 6, 193--205. doi: 10.1111/1755-0998.12435

## Citation

Villamil, J. et al. in review.
